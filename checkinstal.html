<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Checklist instalasi PC untuk Atlantis Corporation - Desain modern, interaktif, dan profesional">
  <title>Checklist Instalasi PC - Atlantis Corporation</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script> <!-- Untuk ekspor PDF -->

  <style>
    body {
      background: linear-gradient(to bottom right, #e0f7fa, #ffffff);
      transition: background-color 0.3s, color 0.3s;
    }
    body.dark-mode {
      background: linear-gradient(to bottom right, #333333, #1a1a1a);
      color: #ffffff;
    }
    table th, table td {
      border: 1px solid #e5e7eb;
    }
    tr:hover {
      background-color: #f0f9ff;
    }
    input[type="checkbox"]:checked + td {
      background-color: #d1e7dd;
    }
    .card {
      background-color: #ffffff;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s ease;
    }
    body.dark-mode .card {
      background-color: #2d2d2d;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.5);
    }
    .progress-bar {
      height: 20px;
      background-color: #e5e7eb;
      border-radius: 10px;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      background-color: #10b981;
      width: 0;
      transition: width 0.5s ease;
    }
  </style>
</head>
<body class="font-inter min-h-screen">
  <div class="container mx-auto p-6">
    <h1 class="text-4xl font-bold text-center mb-8 text-blue-700 transition duration-500 ease-in-out animate-fade-in">Checklist Instalasi PC</h1>

    <!-- Tombol Dark Mode -->
    <div class="text-right mb-4">
      <button id="darkModeToggle" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2 px-4 rounded transition">
        Toggle Dark Mode
      </button>
    </div>

    <!-- Progress Bar -->
    <div class="mb-6 text-center">
      <p id="progressText" class="text-xl font-semibold">Progress: 0% Selesai</p>
      <div class="progress-bar w-full">
        <div id="progressFill" class="progress-fill"></div>
      </div>
    </div>

    <div class="card p-6 mb-10 animate-fade-in-delay-1">
      <h2 class="text-2xl font-semibold mb-4 text-blue-600 flex items-center"><i class="fas fa-tools mr-2"></i> Instalasi Hardware</h2>
      <table class="w-full border-collapse">
        <thead>
          <tr class="bg-blue-100">
            <th class="p-3 border text-left">Checklist</th>
            <th class="p-3 border text-center">Status</th>
            <th class="p-3 border text-left">Catatan</th>
          </tr>
        </thead>
        <tbody id="hardwareTable" class="bg-white">
        </tbody>
      </table>
    </div>

    <div class="card p-6 animate-fade-in-delay-2">
      <h2 class="text-2xl font-semibold mb-4 text-blue-600 flex items-center"><i class="fas fa-laptop mr-2"></i> Instalasi Software</h2>
      <table class="w-full border-collapse">
        <thead>
          <tr class="bg-blue-100">
            <th class="p-3 border text-left">Checklist</th>
            <th class="p-3 border text-center">Status</th>
            <th class="p-3 border text-left">Catatan</th>
          </tr>
        </thead>
        <tbody id="softwareTable" class="bg-white">
        </tbody>
      </table>
    </div>

    <div class="text-center mt-10">
      <button onclick="exportToExcel()" class="bg-green-500 hover:bg-green-700 text-white font-semibold px-6 py-3 rounded-xl shadow-lg transition transform hover:scale-105">ðŸ’¾ Export ke Excel</button>
      <button onclick="exportToPDF()" class="bg-blue-500 hover:bg-blue-700 text-white font-semibold px-6 py-3 rounded-xl shadow-lg ml-4 transition transform hover:scale-105">ðŸ“„ Export ke PDF</button>
    </div>
  </div>

  <!-- Footer -->
  <footer class="text-center py-4 mt-10 border-t border-gray-200">
    <p>&copy; 2023 Atlantis Corporation. All rights reserved. <a href="#" class="text-blue-500 hover:underline">Visit our website</a></p>
  </footer>

  <script defer>
    const hardwareData = [ /* Data asli */ ];
    const softwareData = [ /* Data asli */ ];

    function createTableRows(data, tableId) {
      const table = document.getElementById(tableId);
      data.forEach(item => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td class="border p-3">${item}</td>
          <td class="border p-3 text-center"><input type="checkbox" class="w-5 h-5" onchange="highlightRow(this); updateProgress()"></td>
          <td class="border p-3"><input type="text" placeholder="Catatan..." class="w-full border rounded p-2" onblur="validateNote(this)"></td>
        `;
        table.appendChild(row);
      });
    }

    createTableRows(hardwareData, "hardwareTable");
    createTableRows(softwareData, "softwareTable");

    function highlightRow(checkbox) {
      const row = checkbox.closest('tr');
      if (checkbox.checked) {
        row.style.backgroundColor = '#d1e7dd';
      } else {
        row.style.backgroundColor = '';
      }
    }

    function updateProgress() {
      const checkboxes = document.querySelectorAll('input[type="checkbox"]:checked');
      const totalItems = document.querySelectorAll('input[type="checkbox"]').length;
      const completed = checkboxes.length;
      const percentage = (completed / totalItems) * 100;
      document.getElementById('progressFill').style.width = percentage + '%';
      document.getElementById('progressText').textContent = `Progress: ${percentage.toFixed(0)}% Selesai`;
    }

    function validateNote(input) {
      const row = input.closest('tr');
      const checkbox = row.querySelector('input[type="checkbox"]');
      if (!checkbox.checked && input.value.trim() === '') {
        alert('Catatan wajib diisi untuk item yang belum selesai!');
        input.focus();
      }
    }

    function exportToExcel() {
      if (confirm('Apakah Anda yakin ingin mengekspor?')) {
        const wb = XLSX.utils.book_new();
        // Kode ekspor asli dengan date stamp
        const date = new Date().toLocaleString();
        const hwData = [["Checklist", "Status", "Catatan", "Tanggal: " + date]];
        // ... (proses ekspor asli) ...
        XLSX.writeFile(wb, `Checklist_Instalasi_PC_Atlantis_${date}.xlsx`);
      }
    }

    function exportToPDF() {
      if (confirm('Apakah Anda yakin ingin mengekspor ke PDF?')) {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        doc.text('Checklist Instalasi PC', 10, 10);
        // Sederhana: Tambahkan logika untuk isi, tapi untuk sekarang, hanya contoh
        doc.save(`Checklist_Instalasi_PC_${new Date().toLocaleString()}.pdf`);
      }
    }

    // Dark Mode Toggle
    document.getElementById('darkModeToggle').addEventListener('click', () => {
      document.body.classList.toggle('dark-mode');
    });

    // Inisialisasi
    document.addEventListener('DOMContentLoaded', updateProgress);
  </script>
</body>
</html>
